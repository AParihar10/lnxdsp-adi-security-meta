From 436f3110484021e6b015c1d59b242af6fe36d397 Mon Sep 17 00:00:00 2001
From: Greg Malysa <greg.malysa@timesys.com>
Date: Wed, 12 Jul 2023 21:39:01 -0400
Subject: [PATCH] sc598: enable optee

---
 arch/arm64/boot/dts/adi/sc598-som.dtsi       | 7 +++++++
 arch/arm64/configs/sc598-som-ezkit_defconfig | 2 ++
 2 files changed, 9 insertions(+)

diff --git a/arch/arm64/boot/dts/adi/sc598-som.dtsi b/arch/arm64/boot/dts/adi/sc598-som.dtsi
index ea34b3fb8d3e..2fbb3096a3a0 100644
--- a/arch/arm64/boot/dts/adi/sc598-som.dtsi
+++ b/arch/arm64/boot/dts/adi/sc598-som.dtsi
@@ -93,6 +93,13 @@ sharc1: core2-rproc@0x28a40000 {
 
 	};
 
+	firmware {
+		optee {
+			compatible = "linaro,optee-tz";
+			method = "smc";
+		};
+	};
+
 };
 
 &tru {
diff --git a/arch/arm64/configs/sc598-som-ezkit_defconfig b/arch/arm64/configs/sc598-som-ezkit_defconfig
index 567c85cde9f0..68b9f1665654 100644
--- a/arch/arm64/configs/sc598-som-ezkit_defconfig
+++ b/arch/arm64/configs/sc598-som-ezkit_defconfig
@@ -304,6 +304,8 @@ CONFIG_ADI_ADSP_IRQ=y
 CONFIG_PHY_XGENE=y
 CONFIG_PHY_QCOM_USB_HS=y
 CONFIG_HISI_PMU=y
+CONFIG_TEE=y
+CONFIG_OPTEE=y
 CONFIG_EXT2_FS=y
 CONFIG_EXT4_FS=y
 CONFIG_EXT4_FS_POSIX_ACL=y
-- 
2.38.2

